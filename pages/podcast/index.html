<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="https://pub-aad15324564c43c49955b96d781f71eb.r2.dev/JCS%20Logo%20Black%20Background.png" />
  <title>Quality Values Podcast — Jacob Shields</title>
  <!-- Shared stylesheet handles the grid, cards, buttons, and modal. -->
  <link rel="stylesheet" href="/assets/styles.css" />
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X00G23WVDJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-X00G23WVDJ');
</script>
</head>

<body>
  <main class="podcast-page">
    <!-- Lightweight nav for consistency across the site. -->
    <p class="nav">
      <a href="/">← Back to home</a>
      <span class="dot">•</span>
      <a href="/pages/projects/">Projects</a>
      <span class="dot">•</span>
      <a href="/contact/">Contact</a>
    </p>

    <!-- ONE grid only -->
    <section class="podcast-topgrid">

      <!-- LEFT COLUMN -->
      <div class="top-left">
        <!-- Page intro describes the overall theme of the show. -->
        <h1 class="podcast-title">Quality Values Podcast</h1>

        <p class="lede">
          Core Question: What are your values in the context of your story?<br>
          Long-form conversations about values, craft, and systems — with people I’m learning from.
        </p>

        <a class="btn"
           href="https://www.youtube.com/playlist?list=PLcDYjJATsN-Nn0Fs5HLuIq5EIzDcA9tgg"
           target="_blank" rel="noopener noreferrer">
          Open on YouTube
        </a>

        <hr class="tight-hr">

        <!-- 1) Full Podcast (Latest) -->
        <!-- Each row-block is a horizontal carousel populated by JS below. -->
        <section class="row-block row-block--tight">
          <div class="row-head">
            <h2 class="row-title">Full Podcast (Latest)</h2>
            <div class="row-controls">
              <button class="icon-btn" type="button" aria-label="Scroll left"  data-row="row-full" data-dir="-1">◀</button>
              <button class="icon-btn" type="button" aria-label="Scroll right" data-row="row-full" data-dir="1">▶</button>
            </div>
          </div>
          <div class="status" id="status-full"></div>
          <div class="row row--small" id="row-full"></div>
        </section>

        <hr class="tight-hr">

        <!-- 2) Highlight Episodes -->
        <section class="row-block row-block--tight">
          <div class="row-head">
            <h2 class="row-title">Highlight Episodes</h2>
            <div class="row-controls">
              <button class="icon-btn" type="button" aria-label="Scroll left"  data-row="row-highlights" data-dir="-1">◀</button>
              <button class="icon-btn" type="button" aria-label="Scroll right" data-row="row-highlights" data-dir="1">▶</button>
            </div>
          </div>
          <div class="status" id="status-highlights"></div>
          <div class="row row--small" id="row-highlights"></div>
        </section>

        <hr class="tight-hr">

        <!-- 3) Movement Episodes -->
        <section class="row-block row-block--tight">
          <div class="row-head">
            <h2 class="row-title">Movement Episodes</h2>
            <div class="row-controls">
              <button class="icon-btn" type="button" aria-label="Scroll left"  data-row="row-movement" data-dir="-1">◀</button>
              <button class="icon-btn" type="button" aria-label="Scroll right" data-row="row-movement" data-dir="1">▶</button>
            </div>
          </div>
          <div class="status" id="status-movement"></div>
          <div class="row row--small" id="row-movement"></div>
        </section>

        <hr class="tight-hr">

        <!-- 4) Science & Sustainability -->
        <section class="row-block row-block--tight">
          <div class="row-head">
            <h2 class="row-title">Science &amp; Sustainability</h2>
            <div class="row-controls">
              <button class="icon-btn" type="button" aria-label="Scroll left"  data-row="row-science" data-dir="-1">◀</button>
              <button class="icon-btn" type="button" aria-label="Scroll right" data-row="row-science" data-dir="1">▶</button>
            </div>
          </div>
          <div class="status" id="status-science"></div>
          <div class="row row--small" id="row-science"></div>
        </section>

        <hr class="tight-hr">

        <!-- 5) Entrepreneurship Episodes -->
        <section class="row-block row-block--tight">
          <div class="row-head">
            <h2 class="row-title">Entrepreneurship Episodes</h2>
            <div class="row-controls">
              <button class="icon-btn" type="button" aria-label="Scroll left"  data-row="row-entrepreneurship" data-dir="-1">◀</button>
              <button class="icon-btn" type="button" aria-label="Scroll right" data-row="row-entrepreneurship" data-dir="1">▶</button>
            </div>
          </div>
          <div class="status" id="status-entrepreneurship"></div>
          <div class="row row--small" id="row-entrepreneurship"></div>
        </section>
      </div>

      <!-- RIGHT COLUMN: Clips (ONLY ONCE) -->
      <!-- This column is sticky so clips stay visible while you scroll. -->
      <aside class="top-right">
        <div class="row-head row-head--clips">
          <h2 class="row-title">Clips</h2>
          <div class="row-controls">
            <button class="icon-btn" type="button" aria-label="Scroll up" data-row="row-clips" data-dir="-1" data-axis="y">▲</button>
            <button class="icon-btn" type="button" aria-label="Scroll down" data-row="row-clips" data-dir="1" data-axis="y">▼</button>
          </div>
        </div>
      
        <div class="status" id="status-clips"></div>
      
        <div class="clips-viewport">
          <div class="clips-rail" id="row-clips"></div>
        </div>
      </aside>


    </section>
  </main>

  <!-- ===== ONE modal player ===== -->
  <!-- Cards open the modal so we can play videos without leaving the page. -->
  <div class="modal" id="playerModal" aria-hidden="true">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Video player">
      <button class="modal-close" data-close aria-label="Close">✕</button>
      <div class="player-wrap" id="playerWrap"></div>
    </div>
  </div>

  <script>
    const PLAYLISTS = [
      { title: "Full Podcast (Latest)", playlistId: "PLcDYjJATsN-Nn0Fs5HLuIq5EIzDcA9tgg", rowId: "row-full", statusId: "status-full", displayCount: 10 },
      { title: "Highlight Episodes", playlistId: "PLcDYjJATsN-OGocXwl1Hkqb3HWdSf6GA0", rowId: "row-highlights", statusId: "status-highlights", displayCount: 10 },
      { title: "Movement Episodes", playlistId: "PLcDYjJATsN-Mbc7QGlLSuLgeQZzDzS9KY", rowId: "row-movement", statusId: "status-movement", displayCount: 10 },
      { title: "Science & Sustainability", playlistId: "PLcDYjJATsN-PtE4LDtPYqaJ7d3lx3Ov4r", rowId: "row-science", statusId: "status-science", displayCount: 10 },
      { title: "Entrepreneurship Episodes", playlistId: "PLcDYjJATsN-Msn3AQKaegXhSZdkiLVsgC", rowId: "row-entrepreneurship", statusId: "status-entrepreneurship", displayCount: 10 },
      { title: "Clips", playlistId: "PLcDYjJATsN-NiSRQwR9BepKMA0LiV6t-p", rowId: "row-clips", statusId: "status-clips", displayCount: 25 },
    ];
    const LIMIT_PER_PLAYLIST = 120;

    function escapeHtml(s) {
      return (s || "").replace(/[&<>"']/g, (c) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[c]));
    }

    function cardHTML(item) {
      return `
        <button class="card" type="button" data-video="${item.videoId}" title="${escapeHtml(item.title)}">
          <div class="thumb">
            <img src="${item.thumb}" alt="${escapeHtml(item.title)}" loading="lazy" />
            <div class="play">▶</div>
          </div>
          <div class="card-title">${escapeHtml(item.title)}</div>
        </button>
      `;
    }

    function mapPlaylistItem(item) {
      const videoId = item?.contentDetails?.videoId || item?.snippet?.resourceId?.videoId || "";
      const thumb = item?.snippet?.thumbnails?.high?.url
        || item?.snippet?.thumbnails?.medium?.url
        || item?.snippet?.thumbnails?.default?.url
        || `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`;

      return {
        title: item?.snippet?.title || "",
        videoId,
        thumb,
      };
    }

    async function fetchPlaylistItems(playlistId, limit = LIMIT_PER_PLAYLIST) {
      let items = [];
      let pageToken = "";

      while (items.length < limit) {
        const params = new URLSearchParams({
          playlistId,
          maxResults: String(Math.min(50, limit - items.length)),
        });

        if (pageToken) params.set("pageToken", pageToken);

        const response = await fetch(`/api/youtube-playlist?${params.toString()}`);
        if (!response.ok) {
          const body = await response.text();
          throw new Error(`YouTube API request failed (${response.status}): ${body}`);
        }

        const payload = await response.json();
        const nextItems = Array.isArray(payload.items) ? payload.items.map(mapPlaylistItem).filter((x) => x.videoId) : [];
        items = items.concat(nextItems);

        pageToken = payload.nextPageToken || "";
        if (!pageToken || !nextItems.length) break;
      }

      return items.slice(0, limit);
    }

    async function loadPlaylistInto({ rowId, statusId, playlistId, displayCount }) {
      const row = document.getElementById(rowId);
      const status = document.getElementById(statusId);
      if (!row || !status) return;

      status.textContent = "Loading…";

      try {
        const items = await fetchPlaylistItems(playlistId, LIMIT_PER_PLAYLIST);

        if (!items.length) {
          status.textContent = "No videos found right now.";
          row.innerHTML = "";
          return;
        }

        row.innerHTML = items.slice(0, displayCount).map(cardHTML).join("");
        status.textContent = "";
      } catch (error) {
        row.innerHTML = "";
        status.textContent = "Could not load videos right now. Please try again later.";
        console.error(error);
      }
    }

    const modal = document.getElementById("playerModal");
    const playerWrap = document.getElementById("playerWrap");

    function openPlayer(videoId) {
      if (!/^[A-Za-z0-9_-]{6,20}$/.test(videoId || "")) return;
      modal.setAttribute("aria-hidden", "false");
      modal.classList.add("open");
      playerWrap.innerHTML =
        `<iframe
          src="https://www.youtube.com/embed/${videoId}?autoplay=1"
          title="YouTube video player"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen></iframe>`;
    }

    function closePlayer() {
      modal.setAttribute("aria-hidden", "true");
      modal.classList.remove("open");
      playerWrap.innerHTML = "";
    }

    function scrollRow(el, dir, axis) {
      if (!el) return;

      if (axis === "y") {
        const card = el.querySelector(".card");
        const isMobile = window.matchMedia("(max-width: 900px)").matches;

        if (isMobile) {
          const step = card ? (card.getBoundingClientRect().width + 10) : 220;
          el.scrollBy({ left: dir * step, behavior: "smooth" });
          return;
        }

        const step = card ? (card.getBoundingClientRect().height + 10) : 220;
        el.scrollBy({ top: dir * step, behavior: "smooth" });
      } else {
        const amt = Math.round(el.clientWidth * 0.9) * dir;
        el.scrollBy({ left: amt, behavior: "smooth" });
      }
    }

    document.addEventListener("click", (e) => {
      const card = e.target.closest(".card");
      if (card?.dataset.video) openPlayer(card.dataset.video);

      if (e.target.matches("[data-close]")) closePlayer();

      const scrollBtn = e.target.closest("[data-row][data-dir]");
      if (scrollBtn) {
        const axis = scrollBtn.dataset.axis || "x";
        const el = document.getElementById(scrollBtn.dataset.row);
        const dir = Number(scrollBtn.dataset.dir);
        scrollRow(el, dir, axis);
      }
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && modal.classList.contains("open")) closePlayer();
    });

    PLAYLISTS.forEach(loadPlaylistInto);
  </script>
</body>
</html>
