<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/png" href="https://pub-aad15324564c43c49955b96d781f71eb.r2.dev/JCS%20Logo%20Black%20Background.png" />
  <title>Writing — Jacob Conlon Shields</title>
  <!-- Shared styling for nav, buttons, and layout. -->
  <link rel="stylesheet" href="/assets/styles.css" />
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X00G23WVDJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-X00G23WVDJ');
</script>
<script defer src="/assets/analytics.js"></script>
</head>

<body>
  <main>
    <!-- Reusable nav pattern used across non-home pages. -->
    <p class="nav">
      <a href="/" data-ga-event="nav_writing_to_home">Home</a>
      <span class="dot">•</span>
      <a href="/pages/projects/" data-ga-event="nav_writing_to_projects">Projects</a>
      <span class="dot">•</span>
      <a href="/pages/writing/" data-ga-event="nav_writing_to_writing">Writing</a>
      <span class="dot">•</span>
      <a href="/pages/podcast/" data-ga-event="nav_writing_to_podcast">Podcast</a>
      <span class="dot">•</span>
      <a href="/contact/" data-ga-event="nav_writing_to_contact">Contact</a>
    </p>

    <hr class="tight-hr">

    <!-- Page-level purpose: link out to writing-related destinations. -->
    <h1>Writing</h1>
    <p>Creative writing + admin writing.</p>

    <hr class="tight-hr">

    <!-- External writing hub on Substack. -->
    <h2>Substack</h2>
    <p>
      Jump into the latest essays right here, or open Substack in a new tab.
    </p>
    <div class="substack-carousel" aria-label="Recent Substack entries">
      <div class="substack-head">
        <p class="substack-title">Latest essays</p>
        <div class="substack-controls">
          <button class="icon-btn" type="button" aria-label="Scroll left" data-carousel="substack" data-dir="-1" data-ga-event="substack_scroll_left">◀</button>
          <button class="icon-btn" type="button" aria-label="Scroll right" data-carousel="substack" data-dir="1" data-ga-event="substack_scroll_right">▶</button>
        </div>
      </div>
     <div class="substack-track" id="substackTrack" role="list"></div>
    </div>
    <p class="action-row" style="display:flex; gap:10px; flex-wrap:wrap;">
      <button class="btn" type="button" id="openSubstack" data-ga-event="open_substack_reader_modal">Open Substack reader</button>
      <a class="btn"
        data-ga-event="read_on_substack_external"
        href="https://substack.com/@jacobconlanshields"
        target="_blank" rel="noopener noreferrer">
        Read on Substack
      </a>
    </p>

    <hr class="tight-hr">

    <!-- Relative Momentum ebook landing. -->
    <h2>Relative Momentum</h2>
    <p>
      Read the free ebook version on my site (two-page spread + page turn),
      or grab the book on Amazon.
    </p>

    <div class="preview-wrap" aria-label="Relative Momentum preview">
      <div class="preview-head">
        <p class="preview-title">Preview the ebook</p>
        <a class="preview-link" href="/pages/writing/relative-momentum/" data-ga-event="relative_momentum_open_full_reader_link">Open the full reader</a>
      </div>
      <div class="preview-grid" role="list">
        <a class="preview-card" role="listitem" href="/pages/writing/relative-momentum/" aria-label="Open Relative Momentum ebook" data-ga-event="relative_momentum_preview_page_1_click">
          <img src="https://pub-7efa5866e0ab41af9e691f0820376dfc.r2.dev/pages/page-001.jpg" alt="Relative Momentum preview page 1" loading="lazy" />
          <span class="preview-page">Page 1</span>
        </a>
        <a class="preview-card" role="listitem" href="/pages/writing/relative-momentum/" aria-label="Open Relative Momentum ebook" data-ga-event="relative_momentum_preview_page_4_click">
          <img src="https://pub-7efa5866e0ab41af9e691f0820376dfc.r2.dev/pages/page-004.jpg" alt="Relative Momentum preview page 4" loading="lazy" />
          <span class="preview-page">Page 4</span>
        </a>
        <a class="preview-card" role="listitem" href="/pages/writing/relative-momentum/" aria-label="Open Relative Momentum ebook" data-ga-event="relative_momentum_preview_page_5_click">
          <img src="https://pub-7efa5866e0ab41af9e691f0820376dfc.r2.dev/pages/page-005.jpg" alt="Relative Momentum preview page 5" loading="lazy" />
          <span class="preview-page">Page 5</span>
        </a>
        <a class="preview-card" role="listitem" href="/pages/writing/relative-momentum/" aria-label="Open Relative Momentum ebook" data-ga-event="relative_momentum_preview_page_6_click">
          <img src="https://pub-7efa5866e0ab41af9e691f0820376dfc.r2.dev/pages/page-006.jpg" alt="Relative Momentum preview page 6" loading="lazy" />
          <span class="preview-page">Page 6</span>
        </a>
        <a class="preview-card preview-card--cta" role="listitem" href="/pages/writing/relative-momentum/" aria-label="See full book" data-ga-event="relative_momentum_preview_cta_click">
          <span class="preview-arrow">→</span>
          <span class="preview-page">See full book</span>
        </a>
      </div>
    </div>

    <p class="action-row" style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
      <a class="btn" href="/pages/writing/relative-momentum/" data-ga-event="open_free_ebook">Open the free ebook</a>

      <a class="btn"
         data-ga-event="buy_relative_momentum_amazon"
         href="https://a.co/d/fbTRmg4"
         target="_blank" rel="noopener noreferrer">
        Buy on Amazon
      </a>
    </p>

    <hr class="tight-hr">

    <p><a href="/" data-ga-event="writing_back_to_home">← Back to home</a></p>
  </main>

  <div class="modal" id="substackModal" aria-hidden="true">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Substack reader">
      <button class="modal-close" data-close aria-label="Close">✕</button>
      <div class="reader-wrap">
        <iframe
          title="Jacob Conlon Shields Substack"
          src="https://substack.com/@jacobconlanshields"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
        ></iframe>
      </div>
    </div>
  </div>

  <script>
    const substackModal = document.getElementById("substackModal");
    const openSubstack = document.getElementById("openSubstack");
    const substackTrack = document.getElementById("substackTrack");

    const SUBSTACK_FEED = "https://jacobconlanshields.substack.com/feed";
    const SUBSTACK_PROXY = `/substack?url=${encodeURIComponent(SUBSTACK_FEED)}`;
    const SUBSTACK_LIMIT = 12;

    function escapeHtml(s) {
      return (s || "").replace(/[&<>"']/g, (c) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[c]));
    }

    function formatDate(d) {
      if (!d) return "";
      const dt = new Date(d);
      if (Number.isNaN(dt.getTime())) return "";
      return dt.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "numeric" });
    }

    function parseSubstackRss(xmlText) {
      const doc = new DOMParser().parseFromString(xmlText, "text/xml");
      const items = Array.from(doc.getElementsByTagName("item"));

      return items.map((item) => {
        const title = item.getElementsByTagName("title")[0]?.textContent?.trim() || "";
        const link = item.getElementsByTagName("link")[0]?.textContent?.trim() || "";
        const pubDate = item.getElementsByTagName("pubDate")[0]?.textContent?.trim() || "";

        return { title, link, pubDate };
      }).filter(x => x.link);
    }

    function substackCardHTML(post) {
      const date = formatDate(post.pubDate);
      return `
        <a class="substack-entry" role="listitem"
           href="${escapeHtml(post.link)}"
           target="_blank" rel="noopener noreferrer">
          <span class="substack-entry__title">${escapeHtml(post.title)}</span>
          <span class="substack-entry__meta">${date ? date + " · " : ""}Substack</span>
        </a>
      `;
    }

    async function loadSubstack() {
      if (!substackTrack) return;

      substackTrack.innerHTML = `
        <a class="substack-entry" role="listitem"
           href="https://substack.com/@jacobconlanshields"
           target="_blank" rel="noopener noreferrer">
          <span class="substack-entry__title">Loading…</span>
          <span class="substack-entry__meta">Substack</span>
        </a>
      `;

      try {
        const resp = await fetch(SUBSTACK_PROXY);
        if (!resp.ok) throw new Error(`Proxy error ${resp.status}`);
        const xml = await resp.text();

        const posts = parseSubstackRss(xml).slice(0, SUBSTACK_LIMIT);
        if (!posts.length) throw new Error("No RSS items found");

        substackTrack.innerHTML = posts.map(substackCardHTML).join("");
      } catch (err) {
        console.error(err);
        substackTrack.innerHTML = `
          <a class="substack-entry" role="listitem"
             href="https://substack.com/@jacobconlanshields"
             target="_blank" rel="noopener noreferrer">
            <span class="substack-entry__title">Couldn’t load Substack right now</span>
            <span class="substack-entry__meta">Open on Substack</span>
          </a>
        `;
      }
    }

    const closeModal = () => {
      substackModal.classList.remove("open");
      substackModal.setAttribute("aria-hidden", "true");
    };

    const openModal = () => {
      substackModal.classList.add("open");
      substackModal.setAttribute("aria-hidden", "false");
    };

    openSubstack?.addEventListener("click", () => {
      openModal();
      window.JCSAnalytics?.trackEvent("substack_modal_open");
    });

    substackModal?.addEventListener("click", (event) => {
      if (event.target.closest("[data-close]")) {
        closeModal();
        window.JCSAnalytics?.trackEvent("substack_modal_close_click");
      }
    });

    document.addEventListener("keydown", (event) => {
      if (event.key === "Escape" && substackModal.classList.contains("open")) {
        closeModal();
        window.JCSAnalytics?.trackEvent("substack_modal_close_escape");
      }
    });

    document.querySelectorAll("[data-carousel='substack']").forEach((button) => {
      button.addEventListener("click", () => {
        const direction = Number(button.dataset.dir || 1);
        const card = substackTrack?.querySelector(".substack-entry");
        if (!card || !substackTrack) return;
        const gap = 12;
        const offset = card.getBoundingClientRect().width + gap;
        substackTrack.scrollBy({ left: offset * direction, behavior: "smooth" });
      });
    });

    window.JCSAnalytics?.trackPageView("page_view_writing", "writing");
    loadSubstack();
  </script>
</body>
</html>
